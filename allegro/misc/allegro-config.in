#!/bin/sh
#
#  Note: allegro-config is generated from allegro-config.in, by autoconf.
#
#  This script returns suitable commandline options for compiling programs
#  using the Allegro library, for example:
#
#     gcc myprog.c -o myprog `allegro-config --libs`
#
#  This is heavily based on a similar script from GTK.

version=4.0.0

prefix=@prefix@
exec_prefix=$prefix
exec_prefix_set=no

static_libs=@LINK_WITH_STATIC_LIBS@
lib_type=@LIB_TO_LINK@

allegro_ldflags=`echo "@LDFLAGS@" | sed -e "s/ -s\b//"`
allegro_libs="@LIBS@"
allegro_cflags=""

usage()
{
   cat <<EOF

Usage: allegro-config [OPTIONS] [LIBRARIES]

Options:
	--prefix[=DIR]
	--exec-prefix[=DIR]
	--version
	--cflags
	--libs
	--static
	--shared
	--env

Libraries:
	release
	debug
	profile
EOF
   exit $1
}

if test $# -eq 0; then
   usage 1 1>&2
fi

while test $# -gt 0; do
   case "$1" in
   -*=*) optarg=`echo "$1" | sed 's/[-_a-zA-Z0-9]*=//'` ;;
   *) optarg= ;;
   esac

   case $1 in

      --prefix=*)
	 prefix=$optarg
	 if test $exec_prefix_set = no; then
	    exec_prefix=$optarg
	 fi
      ;;

      --prefix)
	 echo_prefix=yes
      ;;

      --exec-prefix=*)
	 exec_prefix=$optarg
	 exec_prefix_set=yes
      ;;

      --exec-prefix)
	 echo_exec_prefix=yes
      ;;

      --version)
	 echo $version
      ;;

      --cflags)
	 echo_cflags=yes
      ;;

      --libs)
	 echo_libs=yes
      ;;

      --static)
	 static_libs=yes
	 echo_libs=yes
      ;;

      --shared)
	 static_libs=no
	 echo_libs=yes
      ;;

      --env)
	 echo_env=yes
      ;;

      release)
	 lib_type=alleg
      ;;

      debug)
	 allegro_cflags=-DDEBUGMODE $allegro_cflags
	 lib_type=alld
      ;;

      profile)
	 lib_type=allp
      ;;

      *)
	 usage 1 1>&2
      ;;

   esac
   shift
done

if test "$echo_prefix" = "yes"; then
   echo $prefix
fi

if test "$echo_exec_prefix" = "yes"; then
   echo $exec_prefix
fi

if test "$echo_cflags" = "yes"; then
   echo -I${prefix}/include $allegro_cflags
fi

if test "$echo_libs" = "yes"; then
   libdirs=-L${exec_prefix}/lib
   if test "$static_libs" = "yes"; then
      echo $libdirs $allegro_ldflags -l${lib_type} $allegro_libs
   else
      echo $libdirs $allegro_ldflags -l${lib_type}-${version} -l${lib_type}_unsharable
   fi
fi

if test "$echo_env" = "yes"; then
	echo "export PATH=\$PATH:$prefix/bin"
	echo "export LD_LIBRARY_PATH=\$LD_LIBRARY_PATH:$prefix/lib"
	echo "export LIBRARY_PATH=\$LIBRARY_PATH:$prefix/lib"
	echo "export C_INCLUDE_PATH=\$C_INCLUDE_PATH:$prefix/include"
	echo "export CPLUS_INCLUDE_PATH=\$CPLUS_INCLUDE_PATH:$prefix/include"
	echo "export OBJC_INCLUDE_PATH=\$OBJC_INCLUDE_PATH:$prefix/include"
fi

